<ion-content>

  <ion-grid>
    <ion-row>

      <ion-col size="3">

        <ion-text color="medium">
          <h1 *ngIf="totalPuzzlesInBlock > 0" class="ion-text-center">
            {{ countPuzzlesPlayedBlock }} / {{totalPuzzlesInBlock }}
          </h1>
          <h3 *ngIf="showBlockTimer" class="ion-text-center">{{ timeLeftBlock | secondsToMinutesSeconds }}</h3>
          <h6 class="ion-text-center">{{ timeTraining | secondsToMinutesSeconds }}</h6>
        </ion-text>

      </ion-col>

      <ion-col class="ion-no-padding ion-margin-top" size="12" size-sm="12" size-md="12" size-lg="6" size-xl="6">




        <ion-accordion-group multiple="true" *ngIf="showEndPlan; else elseTemplateBoardPuzzle"
          [value]="valueAccordionGroup">

          <ion-accordion *ngFor="let block of plan?.blocks; let i=index" [value]="plan?.uid+i">
            <ion-item slot="header" color="light">
              <ion-label>
                <h2>
                  {{ block.title || block.themes[0] || block.openingFamily }}
                </h2>
                <p>
                  {{ block.description }}
                </p>
              </ion-label>
            </ion-item>
            <div class="ion-padding" slot="content">

              <ion-row>
                <ion-col size="3" *ngFor="let userPuzzle of block.puzzlesPlayed">

                  <ion-card class="ion-no-margin">

                    <ion-card-content class="ion-no-padding">
                      <app-fen-board
                        [setFen]="{ fen: userPuzzle.fenStartUserPuzzle, firstMoveSquaresHighlight: userPuzzle.firstMoveSquaresHighlight }"></app-fen-board>
                    </ion-card-content>
                    <ion-item>
                      <ion-label>
                        {{userPuzzle.eloPuzzle}}
                      </ion-label>

                      <ng-container *ngIf="userPuzzle.failByTime; else elseTemplateFailByTime">

                        <ion-icon slot="end" color="danger" name="alarm"></ion-icon>
                      </ng-container>
                      <ng-template #elseTemplateFailByTime>

                        <ion-icon *ngIf="userPuzzle.resolved" color="success" slot="end"
                          name="checkmark-circle"></ion-icon>
                        <ion-icon *ngIf="!userPuzzle.resolved" color="danger" slot="end" name="close-circle"></ion-icon>
                      </ng-template>



                    </ion-item>
                  </ion-card>

                </ion-col>
              </ion-row>

            </div>
          </ion-accordion>

        </ion-accordion-group>


        <ng-template #elseTemplateBoardPuzzle>

          <app-board-puzzle [setPuzzle]="puzzleToPlay" [setForceStopTimer]="forceStopTimerInPuzzleBoard"
            (puzzleCompleted)="onPuzzleCompleted($event, 'good')" (puzzleFailed)="onPuzzleCompleted($event, 'bad')"
            (puzzleEndByTime)="onPuzzleCompleted($event, 'timeOut')"></app-board-puzzle>
        </ng-template>

      </ion-col>



    </ion-row>
  </ion-grid>


</ion-content>